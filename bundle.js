!function(n){var t={};function e(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:o})},e.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=2)}([function(n,t){var e=class n{constructor(n,t){this.x=n,this.y=t}plus(t){return new n(this.x+t.x,this.y+t.y)}times(t){return new n(this.x*t,this.y*t)}},o=class n{constructor(n,t){this.pos=n,this.speed=t}get type(){return"player"}static create(t){return new n(t.plus(new e(0,-.5)),new e(0,0))}};o.prototype.size=new e(.8,1.5);var s=class n{constructor(n,t,e){this.pos=n,this.speed=t,this.reset=e}get type(){return"lava"}static create(t,o){return"="==o?new n(t,new e(2,0)):"|"==o?new n(t,new e(0,2)):"v"==o?new n(t,new e(0,3),t):void 0}};s.prototype.size=new e(1,1);var r=class n{constructor(n,t,e){this.pos=n,this.basePos=t,this.wobble=e}get type(){return"coin"}static create(t){let o=t.plus(new e(.2,.1));return new n(o,o,Math.random()*Math.PI*2)}};r.prototype.size=new e(.6,.6);var i={".":"empty","#":"wall","+":"lava","@":o,o:r,"=":s,"|":s,v:s};s.prototype.collide=function(n){return new State(n.level,n.actors,"lost")},r.prototype.collide=function(n){let t=n.actors.filter(n=>n!=this),e=n.status;return t.some(n=>"coin"==n.type)||(e="won"),new State(n.level,t,e)},s.prototype.update=function(n,t){let e=this.pos.plus(this.speed.times(n));return t.level.touches(e,this.size,"wall")?this.reset?new s(this.reset,this.speed,this.reset):new s(this.pos,this.speed.times(-1)):new s(e,this.speed,this.reset)};r.prototype.update=function(n){let t=this.wobble+8*n,o=.07*Math.sin(t);return new r(this.basePos.plus(new e(0,o)),this.basePos,t)};o.prototype.update=function(n,t,s){let r=0;s.ArrowLeft&&(r-=7),s.ArrowRight&&(r+=7);let i=this.pos,l=i.plus(new e(r*n,0));t.level.touches(l,this.size,"wall")||(i=l);let a=this.speed.y+30*n,c=i.plus(new e(0,a*n));return t.level.touches(c,this.size,"wall")?a=s.ArrowUp&&a>0?-17:0:i=c,new o(i,new e(r,a))};var l={Vec:e,levelChars:i};n.exports=l},function(n,t,e){var o=e(0),s=o.Vec,r=o.levelChars;var i={GAME_LEVELS:["                                                    \n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n..................................................................###...........\n...................................................##......##....##+##..........\n....................................o.o......##..................#+++#..........\n.................................................................##+##..........\n...................................#####..........................#v#...........\n............................................................................##..\n..##......................................o.o................................#..\n..#.....................o....................................................#..\n..#......................................#####.............................o.#..\n..#..........####.......o....................................................#..\n..#..@.......#..#................................................#####.......#..\n..############..###############...####################.....#######...#########..\n..............................#...#..................#.....#....................\n..............................#+++#..................#+++++#....................\n..............................#+++#..................#+++++#....................\n..............................#####..................#######....................\n................................................................................\n................................................................................\n","                                                                     \n................................................................................\n................................................................................\n....###############################.............................................\n...##.............................##########################################....\n...#.......................................................................##...\n...#....o...................................................................#...\n...#................................................=.......................#...\n...#.o........################...................o..o...........|........o..#...\n...#.........................#..............................................#...\n...#....o....................##########.....###################....##########...\n...#..................................#+++++#.................#....#............\n...###############....oo......=o.o.o..#######.###############.#....#............\n.....#...............o..o.............#.......#......#........#....#............\n.....#....................#############..######.####.#.########....########.....\n.....#.............########..............#...........#.#..................#.....\n.....#..........####......####...#####################.#..................#.....\n.....#........###............###.......................########....########.....\n.....#.......##................#########################......#....#............\n.....#.......#................................................#....#............\n.....###......................................................#....#............\n.......#...............o...........................................#............\n.......#...............................................o...........#............\n.......#########......###.....############.........................##...........\n.............#..................#........#####....#######.o.........########....\n.............#++++++++++++++++++#............#....#.....#..................#....\n.............#++++++++++++++++++#..........###....###...####.o.............#....\n.............####################..........#........#......#.....|.........#....\n...........................................#++++++++#......####............#....\n...........................................#++++++++#.........#........@...#....\n...........................................#++++++++#.........##############....\n...........................................##########...........................\n................................................................................\n","\n......................................#++#........................#######....................................#+#..\n......................................#++#.....................####.....####.................................#+#..\n......................................#++##########...........##...........##................................#+#..\n......................................##++++++++++##.........##.............##...............................#+#..\n.......................................##########++#.........#....................................o...o...o..#+#..\n................................................##+#.........#.....o...o....................................##+#..\n.................................................#+#.........#................................###############++#..\n.................................................#v#.........#.....#...#........................++++++++++++++##..\n.............................................................##..|...|...|..##............#####################...\n..............................................................##+++++++++++##............v........................\n...............................................................####+++++####......................................\n...............................................#.....#............#######........###.........###..................\n...............................................#.....#...........................#.#.........#.#..................\n...............................................#.....#.............................#.........#....................\n...............................................#.....#.............................##........#....................\n...............................................##....#.............................#.........#....................\n...............................................#.....#......o..o.....#...#.........#.........#....................\n...............#######........###...###........#.....#...............#...#.........#.........#....................\n..............##.....##.........#...#..........#.....#.....######....#...#...#########.......#....................\n.............##.......##........#.o.#..........#....##...............#...#...#...............#....................\n.....@.......#.........#........#...#..........#.....#...............#...#...#...............#....................\n....###......#.........#........#...#..........#.....#...............#...#####...######......#....................\n....#.#......#.........#.......##.o.##.........#.....#...............#.....o.....#.#.........#....................\n++++#.#++++++#.........#++++++##.....##++++++++##....#++++++++++.....#.....=.....#.#.........#....................\n++++#.#++++++#.........#+++++##.......##########.....#+++++++##+.....#############.##..o.o..##....................\n++++#.#++++++#.........#+++++#....o.................##++++++##.+....................##.....##.....................\n++++#.#++++++#.........#+++++#.....................##++++++##..+.....................#######......................\n++++#.#++++++#.........#+++++##.......##############++++++##...+..................................................\n++++#.#++++++#.........#++++++#########++++++++++++++++++##....+..................................................\n++++#.#++++++#.........#++++++++++++++++++++++++++++++++##.....+..................................................\n","\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n........................................o.....................................................................\n..............................................................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n.......................................###....................................................................\n.......................................#.#.................+++........+++..###................................\n.......................................#.#.................+#+........+#+.....................................\n.....................................###.###................#..........#......................................\n......................................#...#.................#...oooo...#.......###............................\n......................................#...#.................#..........#......#+++#...........................\n......................................#...#.................############.......###............................\n.....................................##...##......#...#......#................................................\n......................................#...#########...########..............#.#...............................\n......................................#...#...........#....................#+++#..............................\n......................................#...#...........#.....................###...............................\n.....................................##...##..........#.......................................................\n......................................#...#=.=.=.=....#............###........................................\n......................................#...#...........#...........#+++#.......................................\n......................................#...#....=.=.=.=#.....o......###.......###..............................\n.....................................##...##..........#.....................#+++#.............................\n..............................o...o...#...#...........#.....#................##v........###...................\n......................................#...#...........#..............#.................#+++#..................\n.............................###.###.###.###.....o.o..#++++++++++++++#...................v#...................\n.............................#.###.#.#.###.#..........#++++++++++++++#........................................\n.............................#.............#...#######################........................................\n.............................##...........##.........................................###......................\n..###.........................#.....#.....#.........................................#+++#................###..\n..#.#.........................#....###....#..........................................###.................#.#..\n..#...........................#....###....#######........................#####.............................#..\n..#...........................#...........#..............................#...#.............................#..\n..#...........................##..........#..............................#.#.#.............................#..\n..#.......................................#.......|####|....|####|.....###.###.............................#..\n..#................###.............o.o....#..............................#.........###.....................#..\n..#...............#####.......##..........#.............................###.......#+++#..........#.........#..\n..#...............o###o.......#....###....#.............................#.#........###..........###........#..\n..#................###........#############..#.oo.#....#.oo.#....#.oo..##.##....................###........#..\n..#......@..........#.........#...........#++#....#++++#....#++++#....##...##....................#.........#..\n..#############################...........#############################.....################################..\n..............................................................................................................\n..............................................................................................................\n","\n..................................................................................................###.#.......\n......................................................................................................#.......\n..................................................................................................#####.......\n..................................................................................................#...........\n..................................................................................................#.###.......\n..........................o.......................................................................#.#.#.......\n.............................................................................................o.o.o###.#.......\n...................###................................................................................#.......\n.......+..o..+................................................#####.#####.#####.#####.#####.#####.#####.......\n.......#.....#................................................#...#.#...#.#...#.#...#.#...#.#...#.#...........\n.......#=.o..#............#...................................###.#.###.#.###.#.###.#.###.#.###.#.#####.......\n.......#.....#..................................................#.#...#.#...#.#...#.#...#.#...#.#.....#.......\n.......+..o..+............o..................................####.#####.#####.#####.#####.#####.#######.......\n..............................................................................................................\n..........o..............###..............................##..................................................\n..............................................................................................................\n..............................................................................................................\n......................................................##......................................................\n...................###.........###............................................................................\n..............................................................................................................\n..........................o.....................................................#......#......................\n..........................................................##.....##...........................................\n.............###.........###.........###.................................#..................#.................\n..............................................................................................................\n.................................................................||...........................................\n..###########.................................................................................................\n..#.........#.o.#########.o.#########.o.##................................................#...................\n..#.........#...#.......#...#.......#...#.................||..................#.....#.........................\n..#..@......#####...o...#####...o...#####.....................................................................\n..#######.....................................#####.......##.....##.....###...................................\n........#=..................=................=#...#.....................###...................................\n........#######################################...#+++++++++++++++++++++###+++++++++++++++++++++++++++++++++++\n..................................................############################################################\n..............................................................................................................\n"],Level:class{constructor(n){let t=n.trim().split("\n").map(n=>[...n]);this.height=t.length,this.width=t[0].length,this.startActors=[],this.rows=t.map((n,t)=>n.map((n,e)=>{let o=r[n];return"string"==typeof o?o:(this.startActors.push(o.create(new s(e,t),n)),"empty")}))}touches(n,t,e){for(var o=Math.floor(n.x),s=Math.ceil(n.x+t.x),r=Math.floor(n.y),i=Math.ceil(n.y+t.y),l=r;l<i;l++)for(var a=o;a<s;a++)if((a<0||a>=this.width||l<0||l>=this.height?"wall":this.rows[l][a])==e)return!0;return!1}}};n.exports=i},function(n,t,e){"use strict";e.r(t),e.d(t,"DOMDisplay",function(){return i});var o=e(1),s=(o.GAME_LEVELS,o.Level);function r(n,t,...e){let o=document.createElement(n);for(let n of Object.keys(t))o.setAttribute(n,t[n]);for(let n of e)o.appendChild(n);return o}var i=class{constructor(n,t){this.dom=r("div",{class:"game"},function(n){return r("table",{class:"background",style:`width: ${n.width*l}px`},...n.rows.map(n=>r("tr",{style:`height: ${l}px`},...n.map(n=>r("td",{class:n})))))}(t)),this.actorLayer=null,n.appendChild(this.dom)}clear(){this.dom.remove()}setState(n){this.actorLayer&&this.actorLayer.remove(),this.actorLayer=r("div",{},...n.actors.map(n=>{let t=r("div",{class:`actor ${n.type}`});return t.style.width=`${n.size.x*l}px`,t.style.height=`${n.size.y*l}px`,t.style.left=`${n.pos.x*l}px`,t.style.top=`${n.pos.y*l}px`,t})),this.dom.appendChild(this.actorLayer),this.dom.className=`game ${n.status}`,this.scrollPlayerIntoView(n)}scrollPlayerIntoView(n){let t=this.dom.clientWidth,e=this.dom.clientHeight,o=t/3,s=this.dom.scrollLeft,r=s+t,i=this.dom.scrollTop,a=i+e,c=n.player,u=c.pos.plus(c.size.times(.5)).times(l);u.x<s+o?this.dom.scrollLeft=u.x-o:u.x>r-o&&(this.dom.scrollLeft=u.x+o-t),u.y<i+o?this.dom.scrollTop=u.y-o:u.y>a-o&&(this.dom.scrollTop=u.y+o-e)}},l=20;var a=function(n){let t=Object.create(null);function e(e){n.includes(e.key)&&(t[e.key]="keydown"==e.type,e.preventDefault())}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),t}(["ArrowLeft","ArrowRight","ArrowUp"]);function c(n,t){let e=new t(document.body,n),o=State.start(n),s=1;return new Promise(n=>{!function(n){let t=null;requestAnimationFrame(function e(o){if(null!=t){let e=Math.min(o-t,100)/1e3;if(!1===n(e))return}t=o,requestAnimationFrame(e)})}(t=>(o=o.update(t,a),e.setState(o),"playing"==o.status||(s>0?(s-=t,!0):(e.clear(),n(o.status),!1))))})}window.runGame=async function(n,t){for(let e=0;e<n.length;){"won"==await c(new s(n[e]),t)&&e++}console.log("You've won!")}}]);